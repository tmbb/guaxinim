<html>
  <head>
    <meta charset="UTF-8">
    <!-- Licensed under the Apache 2.0 License -->
    <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
    <!-- Licensed under the SIL Open Font License -->
    <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
    <!-- Guzzler docs -->
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
    <!--
      <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
    -->
    <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
    <!-- Guaxinim -->
    <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />

  </head>
  <body>
    <div class="container-wrapper">
      <div id="left-column">
        <div class="sphinxsidebar">
  <a href="#" class="text-logo">
    Guaxinim
  </a>
  <div class="sidebar-block">
    <div class="sidebar-wrapper">
      <h2>Table Of Contents</h2>
    </div>
    <div class="sidebar-toc">
      <ul class="current">
        
        
        <li class="toctree-l1">
          <a class="reference internal" href="..">
            <span class="glyphicon glyphicon-level-up"></span>
            &nbsp;
            <span class="sidebar-toc-level-up">../</span></a></li>
        
        
        
        <li class="toctree-l1">
          <a class="reference internal" href="internal">
            <span class="glyphicon glyphicon-folder-open"></span>
            &nbsp;
            <span class="sidebar-toc-directory">internal/</span></a></li>
        
        <li class="toctree-l1">
          <a class="reference internal" href="templates">
            <span class="glyphicon glyphicon-folder-open"></span>
            &nbsp;
            <span class="sidebar-toc-directory">templates/</span></a></li>
        
        <li class="toctree-l1">
          <a class="reference internal" href="utils">
            <span class="glyphicon glyphicon-folder-open"></span>
            &nbsp;
            <span class="sidebar-toc-directory">utils/</span></a></li>
        
        
        
        <li class="toctree-l1">
          <a class="reference internal" href="ast_inspector.ex.html">
            <span class="glyphicon glyphicon-file"></span>
            &nbsp;
            <span class="sidebar-toc-file">ast_inspector.ex</span></a></li>
        
        <li class="toctree-l1">
          <a class="reference internal" href="beam_inspector.ex.html">
            <span class="glyphicon glyphicon-file"></span>
            &nbsp;
            <span class="sidebar-toc-file">beam_inspector.ex</span></a></li>
        
        <li class="toctree-l1">
          <a class="reference internal" href="config.ex.html">
            <span class="glyphicon glyphicon-file"></span>
            &nbsp;
            <span class="sidebar-toc-file">config.ex</span></a></li>
        
        <li class="toctree-l1">
          <a class="reference internal" href="database.ex.html">
            <span class="glyphicon glyphicon-file"></span>
            &nbsp;
            <span class="sidebar-toc-file">database.ex</span></a></li>
        
      </ul>
    </div>
  </div>
</div>
      </div>

      <div id="right-column">
        <div class="document clearer body">
          <div style="display: flex;" class="guaxinim-docblock guaxinim-inline-comments">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose">
          <div class="panel panel-default" style="margin-bottom: 4px">
            <div class="panel-body">
              <p>This module is not adequately named.
It does inspect the BEAM fies but iit does a lot more than that.
We must change the name to reflect this.</p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L4"></a><a href="#L4">  4</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Guaxinim.BeamInspector</span><span class="w"> </span><span class="k" data-group-id="12067">do</span><span class="w"></span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div style="display: flex;" class="guaxinim-docblock guaxinim-moduledoc">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose">
          <div class="panel panel-default guaxinim-panel">
            <div class="panel-heading">
              <div class="row">
                <div class="col-md-11">
                  <span class="guaxinim-moduledoc-label">@moduledoc</span>
                  
                </div>
                <div class="col-md-1 text-right">
                  <span class="glyphicon glyphicon glyphicon-info-sign"
                    style="margin-top:3px"></span>
                </div>
              </div>
            </div>
            <div class="panel-body">
              <p>A module to gather information from <code class="inline">.beam</code> files</p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L8"></a><a href="#L8">  8</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="w"></span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div style="display: flex;" class="guaxinim-docblock guaxinim-inline-comments">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose">
          <div class="panel panel-default" style="margin-bottom: 4px">
            <div class="panel-body">
              <p>Some tools to inspect the compile manifests, also used by <code class="inline">mix xref</code></p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L10"></a><a href="#L10"> 10</a>
<a id="L11"></a><a href="#L11"> 11</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="w">  </span><span class="kn">alias</span><span class="w"> </span><span class="nc">Mix.Tasks.Compile.Elixir</span><span class="p">,</span><span class="w"> </span><span class="ss">as</span><span class="p">:</span><span class="w"> </span><span class="nc">E</span><span class="w"></span>
<span class="w">  </span><span class="kn">import</span><span class="w"> </span><span class="nc">Mix.Compilers.Elixir</span><span class="p">,</span><span class="w"> </span><span class="ss">only</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="11888">[</span><span class="ss">read_manifest</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="ss">source</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">module</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="11888">]</span><span class="w"></span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div style="display: flex;" class="guaxinim-docblock guaxinim-inline-comments">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose">
          <div class="panel panel-default" style="margin-bottom: 4px">
            <div class="panel-body">
              <p>The module <code class="inline">Amnesia.Helper</code> must be required to avoid some problems with macros
defined by the <code class="inline">Amnesia</code> module. <strong>TODO</strong>: Fix this upstream</p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L14"></a><a href="#L14"> 14</a>
<a id="L15"></a><a href="#L15"> 15</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="w">  </span><span class="kn">require</span><span class="w"> </span><span class="nc">Amnesia.Helper</span><span class="w"></span>
<span class="w">  </span><span class="kn">require</span><span class="w"> </span><span class="nc">Amnesia</span><span class="w"></span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div style="display: flex;" class="guaxinim-docblock guaxinim-inline-comments">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose">
          <div class="panel panel-default" style="margin-bottom: 4px">
            <div class="panel-body">
              <p>Modules related to the database</p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L17"></a><a href="#L17"> 17</a>
<a id="L18"></a><a href="#L18"> 18</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="w">  </span><span class="kn">require</span><span class="w"> </span><span class="nc">Guaxinim.Database</span><span class="o">.</span><span class="p" data-group-id="11889">{</span><span class="nc">ModuleDefinition</span><span class="p">,</span><span class="w"> </span><span class="nc">FunctionDefinition</span><span class="p">,</span><span class="w"> </span><span class="nc">FunctionCall</span><span class="p" data-group-id="11889">}</span><span class="w"></span>
<span class="w">  </span><span class="kn">alias</span><span class="w"> </span><span class="nc">Guaxinim.Database</span><span class="o">.</span><span class="p" data-group-id="11890">{</span><span class="nc">ModuleDefinition</span><span class="p">,</span><span class="w"> </span><span class="nc">FunctionDefinition</span><span class="p">,</span><span class="w"> </span><span class="nc">FunctionCall</span><span class="p" data-group-id="11890">}</span><span class="w"></span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div style="display: flex;" class="guaxinim-docblock guaxinim-inline-comments">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose">
          <div class="panel panel-default" style="margin-bottom: 4px">
            <div class="panel-body">
              <p>Module that contains utilities to traverse the AST directly and gather data
without help from the compile manifests</p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L21"></a><a href="#L21"> 21</a>
<a id="L22"></a><a href="#L22"> 22</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="w">  </span><span class="kn">alias</span><span class="w"> </span><span class="nc">Guaxinim.AstInspector</span><span class="w"></span>
<span class="w"></span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div style="display: flex;" class="guaxinim-docblock guaxinim-doc">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose"> 
          <div class="panel panel-default guaxinim-panel">
            <div class="panel-heading">
              <div class="row">
                <div class="col-md-11">
                  <span class="guaxinim-doc-label">@doc</span>
                  
                </div>
                <div class="col-md-1 text-right">
                  <span class="glyphicon glyphicon glyphicon-info-sign"
                    style="margin-top:3px"></span>
                </div>
              </div>
            </div>
            <div class="panel-body">
              <p>Gets all data from all modules</p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L26"></a><a href="#L26"> 26</a>
<a id="L27"></a><a href="#L27"> 27</a>
<a id="L28"></a><a href="#L28"> 28</a>
<a id="L29"></a><a href="#L29"> 29</a>
<a id="L30"></a><a href="#L30"> 30</a>
<a id="L31"></a><a href="#L31"> 31</a>
<a id="L32"></a><a href="#L32"> 32</a>
<a id="L33"></a><a href="#L33"> 33</a>
<a id="L34"></a><a href="#L34"> 34</a>
<a id="L35"></a><a href="#L35"> 35</a>
<a id="L36"></a><a href="#L36"> 36</a>
<a id="L37"></a><a href="#L37"> 37</a>
<a id="L38"></a><a href="#L38"> 38</a>
<a id="L39"></a><a href="#L39"> 39</a>
<a id="L40"></a><a href="#L40"> 40</a>
<a id="L41"></a><a href="#L41"> 41</a>
<a id="L42"></a><a href="#L42"> 42</a>
<a id="L43"></a><a href="#L43"> 43</a>
<a id="L44"></a><a href="#L44"> 44</a>
<a id="L45"></a><a href="#L45"> 45</a>
<a id="L46"></a><a href="#L46"> 46</a>
<a id="L47"></a><a href="#L47"> 47</a>
<a id="L48"></a><a href="#L48"> 48</a>
<a id="L49"></a><a href="#L49"> 49</a>
<a id="L50"></a><a href="#L50"> 50</a>
<a id="L51"></a><a href="#L51"> 51</a>
<a id="L52"></a><a href="#L52"> 52</a>
<a id="L53"></a><a href="#L53"> 53</a>
<a id="L54"></a><a href="#L54"> 54</a>
<a id="L55"></a><a href="#L55"> 55</a>
<a id="L56"></a><a href="#L56"> 56</a>
<a id="L57"></a><a href="#L57"> 57</a>
<a id="L58"></a><a href="#L58"> 58</a>
<a id="L59"></a><a href="#L59"> 59</a>
<a id="L60"></a><a href="#L60"> 60</a>
<a id="L61"></a><a href="#L61"> 61</a>
<a id="L62"></a><a href="#L62"> 62</a>
<a id="L63"></a><a href="#L63"> 63</a>
<a id="L64"></a><a href="#L64"> 64</a>
<a id="L65"></a><a href="#L65"> 65</a>
<a id="L66"></a><a href="#L66"> 66</a>
<a id="L67"></a><a href="#L67"> 67</a>
<a id="L68"></a><a href="#L68"> 68</a>
<a id="L69"></a><a href="#L69"> 69</a>
<a id="L70"></a><a href="#L70"> 70</a>
<a id="L71"></a><a href="#L71"> 71</a>
<a id="L72"></a><a href="#L72"> 72</a>
<a id="L73"></a><a href="#L73"> 73</a>
<a id="L74"></a><a href="#L74"> 74</a>
<a id="L75"></a><a href="#L75"> 75</a>
<a id="L76"></a><a href="#L76"> 76</a>
<a id="L77"></a><a href="#L77"> 77</a>
<a id="L78"></a><a href="#L78"> 78</a>
<a id="L79"></a><a href="#L79"> 79</a>
<a id="L80"></a><a href="#L80"> 80</a>
<a id="L81"></a><a href="#L81"> 81</a>
<a id="L82"></a><a href="#L82"> 82</a>
<a id="L83"></a><a href="#L83"> 83</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">module_references</span><span class="p" data-group-id="11891">()</span><span class="w"> </span><span class="k" data-group-id="11903">do</span><span class="w"></span>
<span class="w">    </span><span class="n">module_sources</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">manifest</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">E</span><span class="o">.</span><span class="n">manifests</span><span class="p" data-group-id="11892">()</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">manifest_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_manifest</span><span class="p" data-group-id="11893">(</span><span class="n">manifest</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p" data-group-id="11893">)</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">module</span><span class="p" data-group-id="11894">(</span><span class="ss">module</span><span class="p">:</span><span class="w"> </span><span class="n">module</span><span class="p">,</span><span class="w"> </span><span class="ss">sources</span><span class="p">:</span><span class="w"> </span><span class="n">sources</span><span class="p" data-group-id="11894">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">manifest_data</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">source</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sources</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">find</span><span class="p" data-group-id="11897">(</span><span class="n">manifest_data</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">match?</span><span class="p" data-group-id="11896">(</span><span class="n">source</span><span class="p" data-group-id="11895">(</span><span class="ss">source</span><span class="p">:</span><span class="w"> </span><span class="o">^</span><span class="n">source</span><span class="p" data-group-id="11895">)</span><span class="p">,</span><span class="w"> </span><span class="ni">&amp;1</span><span class="p" data-group-id="11896">)</span><span class="p" data-group-id="11897">)</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="11898">{</span><span class="n">module</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="p" data-group-id="11898">}</span><span class="w"></span>
<span class="w"></span>
<span class="w">    </span><span class="nc">Map</span><span class="o">.</span><span class="n">new</span><span class="w"> </span><span class="n">module_sources</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="11902">fn</span><span class="w"> </span><span class="p" data-group-id="11899">{</span><span class="n">module</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="p" data-group-id="11899">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"></span>
<span class="w">      </span><span class="n">source</span><span class="p" data-group-id="11900">(</span><span class="ss">runtime_dispatches</span><span class="p">:</span><span class="w"> </span><span class="n">runtime_dispatches</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="ss">compile_dispatches</span><span class="p">:</span><span class="w"> </span><span class="n">compile_dispatches</span><span class="p" data-group-id="11900">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">source</span><span class="w"></span>
<span class="w"></span>
<span class="w">      </span><span class="p" data-group-id="11901">{</span><span class="n">module</span><span class="p">,</span><span class="w"> </span><span class="n">compile_dispatches</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">runtime_dispatches</span><span class="p" data-group-id="11901">}</span><span class="w"></span>
<span class="w">    </span><span class="k" data-group-id="11902">end</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="11903">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">package_from_path</span><span class="p" data-group-id="11904">(</span><span class="n">path</span><span class="p" data-group-id="11904">)</span><span class="w"> </span><span class="k" data-group-id="11905">do</span><span class="w"></span>
<span class="w">    </span><span class="n">path</span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Path</span><span class="o">.</span><span class="n">dirname</span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Path</span><span class="o">.</span><span class="n">dirname</span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Path</span><span class="o">.</span><span class="n">basename</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="11905">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">flatten_dispatch</span><span class="p" data-group-id="11907">(</span><span class="n">caller_module</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="11906">{</span><span class="n">module</span><span class="p">,</span><span class="w"> </span><span class="n">function_calls</span><span class="p" data-group-id="11906">}</span><span class="p" data-group-id="11907">)</span><span class="w"> </span><span class="k" data-group-id="11918">do</span><span class="w"></span>
<span class="w">    </span><span class="n">module_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Atom</span><span class="o">.</span><span class="n">to_string</span><span class="p" data-group-id="11908">(</span><span class="n">module</span><span class="p" data-group-id="11908">)</span><span class="w"></span>
<span class="w">    </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="11917">(</span><span class="n">function_calls</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="11916">fn</span><span class="w"> </span><span class="p" data-group-id="11910">{</span><span class="p" data-group-id="11909">{</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="n">arity</span><span class="p" data-group-id="11909">}</span><span class="p">,</span><span class="w"> </span><span class="n">lines</span><span class="p" data-group-id="11910">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"></span>
<span class="w">      </span><span class="n">fun_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Atom</span><span class="o">.</span><span class="n">to_string</span><span class="p" data-group-id="11911">(</span><span class="n">fun</span><span class="p" data-group-id="11911">)</span><span class="w"></span>
<span class="w">      </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="11915">(</span><span class="n">lines</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="11914">fn</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"></span>
<span class="w">        </span><span class="p" data-group-id="11913">%</span><span class="nc" data-group-id="11913">FunctionCall</span><span class="p" data-group-id="11913">{</span><span class="w"></span>
<span class="w">          </span><span class="ss">m</span><span class="p">:</span><span class="w"> </span><span class="n">module_name</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="ss">f</span><span class="p">:</span><span class="w"> </span><span class="n">fun_str</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="ss">a</span><span class="p">:</span><span class="w"> </span><span class="n">arity</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="ss">caller_mfa</span><span class="p">:</span><span class="w"> </span><span class="no">nil</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="ss">caller_module</span><span class="p">:</span><span class="w"> </span><span class="n">caller_module</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="ss">file</span><span class="p">:</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="ss">line</span><span class="p">:</span><span class="w"> </span><span class="n">line</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="ss">f_file_line</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="11912">{</span><span class="n">fun_str</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="p" data-group-id="11912">}</span><span class="w"></span>
<span class="w">        </span><span class="p" data-group-id="11913">}</span><span class="w"></span>
<span class="w">      </span><span class="k" data-group-id="11914">end</span><span class="p" data-group-id="11915">)</span><span class="w"></span>
<span class="w">    </span><span class="k" data-group-id="11916">end</span><span class="p" data-group-id="11917">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">List</span><span class="o">.</span><span class="n">flatten</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="11918">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">dispatches_to_function_calls</span><span class="p" data-group-id="11919">(</span><span class="n">caller_module</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">dispatches</span><span class="p" data-group-id="11919">)</span><span class="w"> </span><span class="k" data-group-id="11923">do</span><span class="w"></span>
<span class="w">    </span><span class="n">dispatches</span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="11922">(</span><span class="k" data-group-id="11921">fn</span><span class="w"> </span><span class="n">dispatch</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n"><a class="guaxinim-source-link" href="#L50">flatten_dispatch</a></span><span class="p" data-group-id="11920">(</span><span class="n">caller_module</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">dispatch</span><span class="p" data-group-id="11920">)</span><span class="w"> </span><span class="k" data-group-id="11921">end</span><span class="p" data-group-id="11922">)</span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">List</span><span class="o">.</span><span class="n">flatten</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="11923">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">file_references</span><span class="p" data-group-id="11924">(</span><span class="n">config</span><span class="p" data-group-id="11924">)</span><span class="w"> </span><span class="k" data-group-id="11944">do</span><span class="w"></span>
<span class="w">    </span><span class="n">module_sources</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="n">manifest</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">E</span><span class="o">.</span><span class="n">manifests</span><span class="p" data-group-id="11925">()</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">manifest_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_manifest</span><span class="p" data-group-id="11926">(</span><span class="n">manifest</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p" data-group-id="11926">)</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">module</span><span class="p" data-group-id="11927">(</span><span class="ss">module</span><span class="p">:</span><span class="w"> </span><span class="n">module</span><span class="p">,</span><span class="w"> </span><span class="ss">sources</span><span class="p">:</span><span class="w"> </span><span class="n">sources</span><span class="p" data-group-id="11927">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">manifest_data</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">source</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sources</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="n">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">find</span><span class="p" data-group-id="11930">(</span><span class="n">manifest_data</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">match?</span><span class="p" data-group-id="11929">(</span><span class="n">source</span><span class="p" data-group-id="11928">(</span><span class="ss">source</span><span class="p">:</span><span class="w"> </span><span class="o">^</span><span class="n">source</span><span class="p" data-group-id="11928">)</span><span class="p">,</span><span class="w"> </span><span class="ni">&amp;1</span><span class="p" data-group-id="11929">)</span><span class="p" data-group-id="11930">)</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="11931">{</span><span class="n">module</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="p" data-group-id="11931">}</span><span class="w"></span>
<span class="w"></span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div style="display: flex;" class="guaxinim-docblock guaxinim-inline-comments">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose">
          <div class="panel panel-default" style="margin-bottom: 4px">
            <div class="panel-body">
              <p>This is very fast (possibly the Elixir compiler has already done most of the work)
Parallelizing this loop is not a top priority.</p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L86"></a><a href="#L86"> 86</a>
<a id="L87"></a><a href="#L87"> 87</a>
<a id="L88"></a><a href="#L88"> 88</a>
<a id="L89"></a><a href="#L89"> 89</a>
<a id="L90"></a><a href="#L90"> 90</a>
<a id="L91"></a><a href="#L91"> 91</a>
<a id="L92"></a><a href="#L92"> 92</a>
<a id="L93"></a><a href="#L93"> 93</a>
<a id="L94"></a><a href="#L94"> 94</a>
<a id="L95"></a><a href="#L95"> 95</a>
<a id="L96"></a><a href="#L96"> 96</a>
<a id="L97"></a><a href="#L97"> 97</a>
<a id="L98"></a><a href="#L98"> 98</a>
<a id="L99"></a><a href="#L99"> 99</a>
<a id="L100"></a><a href="#L100">100</a>
<a id="L101"></a><a href="#L101">101</a>
<a id="L102"></a><a href="#L102">102</a>
<a id="L103"></a><a href="#L103">103</a>
<a id="L104"></a><a href="#L104">104</a>
<a id="L105"></a><a href="#L105">105</a>
<a id="L106"></a><a href="#L106">106</a>
<a id="L107"></a><a href="#L107">107</a>
<a id="L108"></a><a href="#L108">108</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="w">    </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="11943">(</span><span class="n">module_sources</span><span class="p">,</span><span class="w"> </span><span class="k" data-group-id="11942">fn</span><span class="w"> </span><span class="p" data-group-id="11932">{</span><span class="n">current</span><span class="p">,</span><span class="w"> </span><span class="n">source</span><span class="p" data-group-id="11932">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"></span>
<span class="w">      </span><span class="n">source</span><span class="p" data-group-id="11933">(</span><span class="ss">runtime_dispatches</span><span class="p">:</span><span class="w"> </span><span class="n">runtime_nested</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="ss">compile_dispatches</span><span class="p">:</span><span class="w"> </span><span class="n">compile_nested</span><span class="p">,</span><span class="w"></span>
<span class="w">             </span><span class="ss">source</span><span class="p">:</span><span class="w"> </span><span class="n">file_relative_to_mix</span><span class="p" data-group-id="11933">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">source</span><span class="w"></span>
<span class="w"></span>
<span class="w">      </span><span class="n">abs_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Path</span><span class="o">.</span><span class="n">absname</span><span class="p" data-group-id="11934">(</span><span class="n">file_relative_to_mix</span><span class="p" data-group-id="11934">)</span><span class="w"></span>
<span class="w">      </span><span class="n">rel_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Path</span><span class="o">.</span><span class="n">relative_to</span><span class="p" data-group-id="11935">(</span><span class="n">abs_file</span><span class="p">,</span><span class="w"> </span><span class="n">config</span><span class="o">.</span><span class="n">src_root</span><span class="p" data-group-id="11935">)</span><span class="w"></span>
<span class="w"></span>
<span class="w">      </span><span class="n">caller_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Atom</span><span class="o">.</span><span class="n">to_string</span><span class="p" data-group-id="11936">(</span><span class="n">current</span><span class="p" data-group-id="11936">)</span><span class="w"></span>
<span class="w">      </span><span class="n">runtime_function_calls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n"><a class="guaxinim-source-link" href="#L69">dispatches_to_function_calls</a></span><span class="p" data-group-id="11937">(</span><span class="n">caller_module</span><span class="p">,</span><span class="w"> </span><span class="n">rel_file</span><span class="p">,</span><span class="w"> </span><span class="n">runtime_nested</span><span class="p" data-group-id="11937">)</span><span class="w"></span>
<span class="w">      </span><span class="n">compile_function_calls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n"><a class="guaxinim-source-link" href="#L69">dispatches_to_function_calls</a></span><span class="p" data-group-id="11938">(</span><span class="n">caller_module</span><span class="p">,</span><span class="w"> </span><span class="n">rel_file</span><span class="p">,</span><span class="w"> </span><span class="n">compile_nested</span><span class="p" data-group-id="11938">)</span><span class="w"></span>
<span class="w">      </span><span class="n">function_calls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">runtime_function_calls</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">compile_function_calls</span><span class="w"></span>
<span class="w"></span>
<span class="w">      </span><span class="nc">Amnesia</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="https://hexdocs.pm/amnesia/Amnesia.html#transaction/1">transaction</a></span><span class="w"> </span><span class="k" data-group-id="11941">do</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">function_call</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">function_calls</span><span class="w"> </span><span class="k" data-group-id="11940">do</span><span class="w"></span>
<span class="w">          </span><span class="nc">FunctionCall</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="database.ex.html#33">write</a></span><span class="p" data-group-id="11939">(</span><span class="n">function_call</span><span class="p" data-group-id="11939">)</span><span class="w"></span>
<span class="w">        </span><span class="k" data-group-id="11940">end</span><span class="w"></span>
<span class="w">      </span><span class="k" data-group-id="11941">end</span><span class="w"></span>
<span class="w">    </span><span class="k" data-group-id="11942">end</span><span class="p" data-group-id="11943">)</span><span class="w"></span>
<span class="w"></span>
<span class="w">    </span><span class="ss">:ok</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="11944">end</span><span class="w"></span>
<span class="w"></span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div style="display: flex;" class="guaxinim-docblock guaxinim-inline-comments">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose">
          <div class="panel panel-default" style="margin-bottom: 4px">
            <div class="panel-body">
              <p>def gather<em>function_definitions_in_module(</em>, _, false), do: :ok</p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L110"></a><a href="#L110">110</a>
<a id="L111"></a><a href="#L111">111</a>
<a id="L112"></a><a href="#L112">112</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">gather_function_definitions_in_module</span><span class="p" data-group-id="11946">(</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="11945">{</span><span class="n">full_module_name</span><span class="p">,</span><span class="w"> </span><span class="n">binary_path</span><span class="p" data-group-id="11945">}</span><span class="p">,</span><span class="w"> </span><span class="n">internal?</span><span class="p" data-group-id="11946">)</span><span class="w"> </span><span class="k" data-group-id="11989">do</span><span class="w"></span>
<span class="w">    </span><span class="n">module_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">String</span><span class="o">.</span><span class="n">trim_leading</span><span class="p" data-group-id="11947">(</span><span class="n">full_module_name</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Elixir.&quot;</span><span class="p" data-group-id="11947">)</span><span class="w"></span>
<span class="w">    </span><span class="k">with</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n"><a class="guaxinim-source-link" href="http://erlang.org/doc/man/erlang.html#is_list-1">is_list</a></span><span class="p" data-group-id="11948">(</span><span class="n">path</span><span class="p" data-group-id="11948">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">to_charlist</span><span class="p" data-group-id="11949">(</span><span class="n">binary_path</span><span class="p" data-group-id="11949">)</span><span class="p">,</span><span class="w"></span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div style="display: flex;" class="guaxinim-docblock guaxinim-inline-comments">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose">
          <div class="panel panel-default" style="margin-bottom: 4px">
            <div class="panel-body">
              <p>Some BEAM introspection magic here…</p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L114"></a><a href="#L114">114</a>
<a id="L115"></a><a href="#L115">115</a>
<a id="L116"></a><a href="#L116">116</a>
<a id="L117"></a><a href="#L117">117</a>
<a id="L118"></a><a href="#L118">118</a>
<a id="L119"></a><a href="#L119">119</a>
<a id="L120"></a><a href="#L120">120</a>
<a id="L121"></a><a href="#L121">121</a>
<a id="L122"></a><a href="#L122">122</a>
<a id="L123"></a><a href="#L123">123</a>
<a id="L124"></a><a href="#L124">124</a>
<a id="L125"></a><a href="#L125">125</a>
<a id="L126"></a><a href="#L126">126</a>
<a id="L127"></a><a href="#L127">127</a>
<a id="L128"></a><a href="#L128">128</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="w">        </span><span class="p" data-group-id="11953">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="11952">{</span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="11951">[</span><span class="ss">debug_info</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="11950">{</span><span class="ss">:debug_info_v1</span><span class="p">,</span><span class="w"> </span><span class="n">backend</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p" data-group-id="11950">}</span><span class="p" data-group-id="11951">]</span><span class="p" data-group-id="11952">}</span><span class="p" data-group-id="11953">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="ss">:beam_lib</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="http://erlang.org/doc/man/beam_lib.html#chunks-2">chunks</a></span><span class="p" data-group-id="11955">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="11954">[</span><span class="ss">:debug_info</span><span class="p" data-group-id="11954">]</span><span class="p" data-group-id="11955">)</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="p" data-group-id="11957">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"></span>
<span class="w">         </span><span class="p" data-group-id="11956">%{</span><span class="ss">definitions</span><span class="p">:</span><span class="w"> </span><span class="n">defs</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="ss">line</span><span class="p">:</span><span class="w"> </span><span class="n">module_line</span><span class="p">,</span><span class="w"></span>
<span class="w">           </span><span class="ss">file</span><span class="p">:</span><span class="w"> </span><span class="n">abs_file</span><span class="p" data-group-id="11956">}</span><span class="p" data-group-id="11957">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">backend</span><span class="o">.</span><span class="n">debug_info</span><span class="p" data-group-id="11960">(</span><span class="ss">:elixir_v1</span><span class="p">,</span><span class="w"> </span><span class="nc">String</span><span class="o">.</span><span class="n">to_atom</span><span class="p" data-group-id="11958">(</span><span class="n">module_name</span><span class="p" data-group-id="11958">)</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="11959">[]</span><span class="p" data-group-id="11960">)</span><span class="w"> </span><span class="k" data-group-id="11988">do</span><span class="w"></span>
<span class="w"></span>
<span class="w">      </span><span class="n">package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n"><a class="guaxinim-source-link" href="#L43">package_from_path</a></span><span class="p" data-group-id="11961">(</span><span class="n">binary_path</span><span class="p" data-group-id="11961">)</span><span class="w"></span>
<span class="w"></span>
<span class="w">      </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">internal?</span><span class="w"> </span><span class="k" data-group-id="11963">do</span><span class="w"></span>
<span class="w">          </span><span class="no">true</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">Path</span><span class="o">.</span><span class="n">relative_to</span><span class="p" data-group-id="11962">(</span><span class="n">abs_file</span><span class="p">,</span><span class="w"> </span><span class="n">config</span><span class="o">.</span><span class="n">src_root</span><span class="p" data-group-id="11962">)</span><span class="w"></span>
<span class="w">          </span><span class="no">false</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">abs_file</span><span class="w"></span>
<span class="w">        </span><span class="k" data-group-id="11963">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">      </span><span class="nc">Amnesia</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="https://hexdocs.pm/amnesia/Amnesia.html#transaction/1">transaction</a></span><span class="w"> </span><span class="k" data-group-id="11987">do</span><span class="w"></span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div style="display: flex;" class="guaxinim-docblock guaxinim-inline-comments">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose">
          <div class="panel panel-default" style="margin-bottom: 4px">
            <div class="panel-body">
              <p>We already have everything about the module</p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L130"></a><a href="#L130">130</a>
<a id="L131"></a><a href="#L131">131</a>
<a id="L132"></a><a href="#L132">132</a>
<a id="L133"></a><a href="#L133">133</a>
<a id="L134"></a><a href="#L134">134</a>
<a id="L135"></a><a href="#L135">135</a>
<a id="L136"></a><a href="#L136">136</a>
<a id="L137"></a><a href="#L137">137</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="w">        </span><span class="p" data-group-id="11964">%</span><span class="nc" data-group-id="11964">ModuleDefinition</span><span class="p" data-group-id="11964">{</span><span class="w"></span>
<span class="w">          </span><span class="ss">m</span><span class="p">:</span><span class="w"> </span><span class="n">module_name</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="ss">file</span><span class="p">:</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="ss">line</span><span class="p">:</span><span class="w"> </span><span class="n">module_line</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="ss">internal?</span><span class="p">:</span><span class="w"> </span><span class="n">internal?</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="ss">package</span><span class="p">:</span><span class="w"> </span><span class="n">package</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="p" data-group-id="11964">}</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">ModuleDefinition</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="database.ex.html#56">write</a></span><span class="w"></span>
<span class="w"></span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div style="display: flex;" class="guaxinim-docblock guaxinim-inline-comments">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose">
          <div class="panel panel-default" style="margin-bottom: 4px">
            <div class="panel-body">
              <p>Now we’re redy to add the function definitions</p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L139"></a><a href="#L139">139</a>
<a id="L140"></a><a href="#L140">140</a>
<a id="L141"></a><a href="#L141">141</a>
<a id="L142"></a><a href="#L142">142</a>
<a id="L143"></a><a href="#L143">143</a>
<a id="L144"></a><a href="#L144">144</a>
<a id="L145"></a><a href="#L145">145</a>
<a id="L146"></a><a href="#L146">146</a>
<a id="L147"></a><a href="#L147">147</a>
<a id="L148"></a><a href="#L148">148</a>
<a id="L149"></a><a href="#L149">149</a>
<a id="L150"></a><a href="#L150">150</a>
<a id="L151"></a><a href="#L151">151</a>
<a id="L152"></a><a href="#L152">152</a>
<a id="L153"></a><a href="#L153">153</a>
<a id="L154"></a><a href="#L154">154</a>
<a id="L155"></a><a href="#L155">155</a>
<a id="L156"></a><a href="#L156">156</a>
<a id="L157"></a><a href="#L157">157</a>
<a id="L158"></a><a href="#L158">158</a>
<a id="L159"></a><a href="#L159">159</a>
<a id="L160"></a><a href="#L160">160</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="w">        </span><span class="n">definitions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p" data-group-id="11965">{</span><span class="n">fun_arity</span><span class="p">,</span><span class="w"> </span><span class="n">keyword</span><span class="p">,</span><span class="w"> </span><span class="n">meta</span><span class="p">,</span><span class="w"> </span><span class="n">_heads</span><span class="p" data-group-id="11965">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">defs</span><span class="p">,</span><span class="w"> </span><span class="ss">into</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="11966">%</span><span class="nc" data-group-id="11966">MapSet</span><span class="p" data-group-id="11966">{}</span><span class="w"> </span><span class="k" data-group-id="11972">do</span><span class="w"></span>
<span class="w">          </span><span class="n">fun_line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Keyword</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="11967">(</span><span class="n">meta</span><span class="p">,</span><span class="w"> </span><span class="ss">:line</span><span class="p" data-group-id="11967">)</span><span class="w"></span>
<span class="w">          </span><span class="p" data-group-id="11968">{</span><span class="n">fun</span><span class="p">,</span><span class="w"> </span><span class="n">arity</span><span class="p" data-group-id="11968">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fun_arity</span><span class="w"></span>
<span class="w">          </span><span class="n">fun_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Atom</span><span class="o">.</span><span class="n">to_string</span><span class="p" data-group-id="11969">(</span><span class="n">fun</span><span class="p" data-group-id="11969">)</span><span class="w"></span>
<span class="w"></span>
<span class="w">          </span><span class="p" data-group-id="11971">%</span><span class="nc" data-group-id="11971">FunctionDefinition</span><span class="p" data-group-id="11971">{</span><span class="w"></span>
<span class="w">            </span><span class="ss">mfa</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="11970">{</span><span class="n">module_name</span><span class="p">,</span><span class="w"> </span><span class="n">fun_str</span><span class="p">,</span><span class="w"> </span><span class="n">arity</span><span class="p" data-group-id="11970">}</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="ss">m</span><span class="p">:</span><span class="w"> </span><span class="n">module_name</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="ss">f</span><span class="p">:</span><span class="w"> </span><span class="n">fun_str</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="ss">a</span><span class="p">:</span><span class="w"> </span><span class="n">arity</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="ss">internal?</span><span class="p">:</span><span class="w"> </span><span class="n">internal?</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="ss">package</span><span class="p">:</span><span class="w"> </span><span class="n">package</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="ss">file</span><span class="p">:</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="ss">line</span><span class="p">:</span><span class="w"> </span><span class="n">fun_line</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="ss">keyword</span><span class="p">:</span><span class="w"> </span><span class="n">keyword</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="ss">meta</span><span class="p">:</span><span class="w"> </span><span class="n">meta</span><span class="w"></span>
<span class="w">          </span><span class="p" data-group-id="11971">}</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">FunctionDefinition</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="database.ex.html#14">write</a></span><span class="w"></span>
<span class="w"></span>
<span class="w">          </span><span class="n">fun_arity</span><span class="w"></span>
<span class="w">        </span><span class="k" data-group-id="11972">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">internal?</span><span class="w"> </span><span class="k" data-group-id="11986">do</span><span class="w"></span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div style="display: flex;" class="guaxinim-docblock guaxinim-inline-comments">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose">
          <div class="panel panel-default" style="margin-bottom: 4px">
            <div class="panel-body">
              <p>After we’ve added the function definitions,
we can add the internal function calls.</p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L163"></a><a href="#L163">163</a>
<a id="L164"></a><a href="#L164">164</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="w">          </span><span class="k">for</span><span class="w"> </span><span class="p" data-group-id="11974">{</span><span class="p" data-group-id="11973">{</span><span class="n">caller_fun</span><span class="p">,</span><span class="w"> </span><span class="n">caller_arity</span><span class="p" data-group-id="11973">}</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="n">heads</span><span class="p" data-group-id="11974">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">defs</span><span class="w"> </span><span class="k" data-group-id="11985">do</span><span class="w"></span>
<span class="w">            </span><span class="n">calls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">AstInspector</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="ast_inspector.ex.html#8">functions_called_by</a></span><span class="p" data-group-id="11975">(</span><span class="n">definitions</span><span class="p">,</span><span class="w"> </span><span class="n">heads</span><span class="p" data-group-id="11975">)</span><span class="w"></span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div style="display: flex;" class="guaxinim-docblock guaxinim-inline-comments">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose">
          <div class="panel panel-default" style="margin-bottom: 4px">
            <div class="panel-body">
              <p>TODO: Handle kernel functions!</p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L166"></a><a href="#L166">166</a>
<a id="L167"></a><a href="#L167">167</a>
<a id="L168"></a><a href="#L168">168</a>
<a id="L169"></a><a href="#L169">169</a>
<a id="L170"></a><a href="#L170">170</a>
<a id="L171"></a><a href="#L171">171</a>
<a id="L172"></a><a href="#L172">172</a>
<a id="L173"></a><a href="#L173">173</a>
<a id="L174"></a><a href="#L174">174</a>
<a id="L175"></a><a href="#L175">175</a>
<a id="L176"></a><a href="#L176">176</a>
<a id="L177"></a><a href="#L177">177</a>
<a id="L178"></a><a href="#L178">178</a>
<a id="L179"></a><a href="#L179">179</a>
<a id="L180"></a><a href="#L180">180</a>
<a id="L181"></a><a href="#L181">181</a>
<a id="L182"></a><a href="#L182">182</a>
<a id="L183"></a><a href="#L183">183</a>
<a id="L184"></a><a href="#L184">184</a>
<a id="L185"></a><a href="#L185">185</a>
<a id="L186"></a><a href="#L186">186</a>
<a id="L187"></a><a href="#L187">187</a>
<a id="L188"></a><a href="#L188">188</a>
<a id="L189"></a><a href="#L189">189</a>
<a id="L190"></a><a href="#L190">190</a>
<a id="L191"></a><a href="#L191">191</a>
<a id="L192"></a><a href="#L192">192</a>
<a id="L193"></a><a href="#L193">193</a>
<a id="L194"></a><a href="#L194">194</a>
<a id="L195"></a><a href="#L195">195</a>
<a id="L196"></a><a href="#L196">196</a>
<a id="L197"></a><a href="#L197">197</a>
<a id="L198"></a><a href="#L198">198</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p" data-group-id="11977">{</span><span class="p" data-group-id="11976">{</span><span class="n">callee_fun</span><span class="p">,</span><span class="w"> </span><span class="n">callee_arity</span><span class="p" data-group-id="11976">}</span><span class="p">,</span><span class="w"> </span><span class="n">meta</span><span class="p" data-group-id="11977">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">calls</span><span class="w"> </span><span class="k" data-group-id="11984">do</span><span class="w"></span>
<span class="w">              </span><span class="n">callee_line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Keyword</span><span class="o">.</span><span class="n">get</span><span class="p" data-group-id="11978">(</span><span class="n">meta</span><span class="p">,</span><span class="w"> </span><span class="ss">:line</span><span class="p" data-group-id="11978">)</span><span class="w"></span>
<span class="w">              </span><span class="n">caller_module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">module_name</span><span class="w"></span>
<span class="w">              </span><span class="n">callee_fun_str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Atom</span><span class="o">.</span><span class="n">to_string</span><span class="p" data-group-id="11979">(</span><span class="n">callee_fun</span><span class="p" data-group-id="11979">)</span><span class="w"></span>
<span class="w">              </span><span class="p" data-group-id="11983">%</span><span class="nc" data-group-id="11983">FunctionCall</span><span class="p" data-group-id="11983">{</span><span class="w"></span>
<span class="w">                </span><span class="ss">m</span><span class="p">:</span><span class="w"> </span><span class="n">module_name</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="ss">f</span><span class="p">:</span><span class="w"> </span><span class="n">callee_fun_str</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="ss">a</span><span class="p">:</span><span class="w"> </span><span class="n">callee_arity</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="ss">caller_mfa</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="11981">{</span><span class="n">module_name</span><span class="p">,</span><span class="w"> </span><span class="nc">Atom</span><span class="o">.</span><span class="n">to_string</span><span class="p" data-group-id="11980">(</span><span class="n">caller_fun</span><span class="p" data-group-id="11980">)</span><span class="p">,</span><span class="w"> </span><span class="n">caller_arity</span><span class="p" data-group-id="11981">}</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="ss">caller_module</span><span class="p">:</span><span class="w"> </span><span class="n">caller_module</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="ss">file</span><span class="p">:</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="ss">line</span><span class="p">:</span><span class="w"> </span><span class="n">callee_line</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="ss">f_file_line</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="11982">{</span><span class="n">callee_fun_str</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">callee_line</span><span class="p" data-group-id="11982">}</span><span class="w"></span>
<span class="w">              </span><span class="p" data-group-id="11983">}</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">FunctionCall</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="database.ex.html#33">write</a></span><span class="w"></span>
<span class="w">            </span><span class="k" data-group-id="11984">end</span><span class="w"></span>
<span class="w">          </span><span class="k" data-group-id="11985">end</span><span class="w"></span>
<span class="w">        </span><span class="k" data-group-id="11986">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">        </span><span class="ss">:ok</span><span class="w"></span>
<span class="w">      </span><span class="k" data-group-id="11987">end</span><span class="w"></span>
<span class="w">    </span><span class="k" data-group-id="11988">end</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="11989">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">modules_from_app_path</span><span class="p" data-group-id="11990">(</span><span class="n">app_path</span><span class="p" data-group-id="11990">)</span><span class="w"> </span><span class="k" data-group-id="12000">do</span><span class="w"></span>
<span class="w">    </span><span class="n">ebin_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Path</span><span class="o">.</span><span class="n">join</span><span class="p" data-group-id="11991">(</span><span class="n">app_path</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ebin&quot;</span><span class="p" data-group-id="11991">)</span><span class="w"></span>
<span class="w">    </span><span class="n">rel_files</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">ebin_path</span><span class="w"></span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">File</span><span class="o">.</span><span class="n">ls!</span><span class="w"></span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">filter</span><span class="p" data-group-id="11993">(</span><span class="o">&amp;</span><span class="nc">String</span><span class="o">.</span><span class="n">ends_with?</span><span class="p" data-group-id="11992">(</span><span class="ni">&amp;1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;.beam&quot;</span><span class="p" data-group-id="11992">)</span><span class="p" data-group-id="11993">)</span><span class="w"></span>
<span class="w"></span>
<span class="w">    </span><span class="n">module_names</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">rel_files</span><span class="w"></span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="11995">(</span><span class="o">&amp;</span><span class="nc">String</span><span class="o">.</span><span class="n">trim_trailing</span><span class="p" data-group-id="11994">(</span><span class="ni">&amp;1</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;.beam&quot;</span><span class="p" data-group-id="11994">)</span><span class="p" data-group-id="11995">)</span><span class="w"></span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div style="display: flex;" class="guaxinim-docblock guaxinim-inline-comments">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose">
          <div class="panel panel-default" style="margin-bottom: 4px">
            <div class="panel-body">
              <p>|&gt; Enum.map(&amp;String.trim_leading(&amp;1, “Elixir.”))</p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L200"></a><a href="#L200">200</a>
<a id="L201"></a><a href="#L201">201</a>
<a id="L202"></a><a href="#L202">202</a>
<a id="L203"></a><a href="#L203">203</a>
<a id="L204"></a><a href="#L204">204</a>
<a id="L205"></a><a href="#L205">205</a>
<a id="L206"></a><a href="#L206">206</a>
<a id="L207"></a><a href="#L207">207</a>
<a id="L208"></a><a href="#L208">208</a>
<a id="L209"></a><a href="#L209">209</a>
<a id="L210"></a><a href="#L210">210</a>
<a id="L211"></a><a href="#L211">211</a>
<a id="L212"></a><a href="#L212">212</a>
<a id="L213"></a><a href="#L213">213</a>
<a id="L214"></a><a href="#L214">214</a>
<a id="L215"></a><a href="#L215">215</a>
<a id="L216"></a><a href="#L216">216</a>
<a id="L217"></a><a href="#L217">217</a>
<a id="L218"></a><a href="#L218">218</a>
<a id="L219"></a><a href="#L219">219</a>
<a id="L220"></a><a href="#L220">220</a>
<a id="L221"></a><a href="#L221">221</a>
<a id="L222"></a><a href="#L222">222</a>
<a id="L223"></a><a href="#L223">223</a>
<a id="L224"></a><a href="#L224">224</a>
<a id="L225"></a><a href="#L225">225</a>
<a id="L226"></a><a href="#L226">226</a>
<a id="L227"></a><a href="#L227">227</a>
<a id="L228"></a><a href="#L228">228</a>
<a id="L229"></a><a href="#L229">229</a>
<a id="L230"></a><a href="#L230">230</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="w"></span>
<span class="w">    </span><span class="n">abs_files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="11997">(</span><span class="n">rel_files</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="nc">Path</span><span class="o">.</span><span class="n">join</span><span class="p" data-group-id="11996">(</span><span class="n">ebin_path</span><span class="p">,</span><span class="w"> </span><span class="ni">&amp;1</span><span class="p" data-group-id="11996">)</span><span class="p" data-group-id="11997">)</span><span class="w"></span>
<span class="w"></span>
<span class="w">    </span><span class="nc">Enum</span><span class="o">.</span><span class="n">zip</span><span class="p" data-group-id="11999">(</span><span class="p" data-group-id="11998">[</span><span class="n">module_names</span><span class="p">,</span><span class="w"> </span><span class="n">abs_files</span><span class="p" data-group-id="11998">]</span><span class="p" data-group-id="11999">)</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="12000">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">abs_ls!</span><span class="p" data-group-id="12001">(</span><span class="n">dir</span><span class="p" data-group-id="12001">)</span><span class="w"> </span><span class="k" data-group-id="12004">do</span><span class="w"></span>
<span class="w">    </span><span class="n">dir</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">File</span><span class="o">.</span><span class="n">ls!</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="12003">(</span><span class="o">&amp;</span><span class="nc">Path</span><span class="o">.</span><span class="n">join</span><span class="p" data-group-id="12002">(</span><span class="n">dir</span><span class="p">,</span><span class="w"> </span><span class="ni">&amp;1</span><span class="p" data-group-id="12002">)</span><span class="p" data-group-id="12003">)</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="12004">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">all_modules</span><span class="p" data-group-id="12005">(</span><span class="n">classifier</span><span class="p" data-group-id="12005">)</span><span class="w"> </span><span class="k" data-group-id="12017">do</span><span class="w"></span>
<span class="w">    </span><span class="nc">Mix.Project</span><span class="o">.</span><span class="n">build_path</span><span class="p" data-group-id="12006">()</span><span class="w"></span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Path</span><span class="o">.</span><span class="n">join</span><span class="p" data-group-id="12007">(</span><span class="s2">&quot;lib&quot;</span><span class="p" data-group-id="12007">)</span><span class="w"></span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="n"><a class="guaxinim-source-link" href="#L206">abs_ls!</a></span><span class="w"></span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="12011">(</span><span class="k" data-group-id="12010">fn</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p" data-group-id="12009">{</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">classifier</span><span class="o">.</span><span class="p" data-group-id="12008">(</span><span class="n">path</span><span class="p" data-group-id="12008">)</span><span class="p" data-group-id="12009">}</span><span class="w"> </span><span class="k" data-group-id="12010">end</span><span class="p" data-group-id="12011">)</span><span class="w"></span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="12016">(</span><span class="k" data-group-id="12015">fn</span><span class="w"> </span><span class="p" data-group-id="12012">{</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">classification</span><span class="p" data-group-id="12012">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"></span>
<span class="w">          </span><span class="k">for</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n"><a class="guaxinim-source-link" href="#L189">modules_from_app_path</a></span><span class="p" data-group-id="12013">(</span><span class="n">path</span><span class="p" data-group-id="12013">)</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="12014">{</span><span class="n">module</span><span class="p">,</span><span class="w"> </span><span class="n">classification</span><span class="p" data-group-id="12014">}</span><span class="w"></span>
<span class="w">         </span><span class="k" data-group-id="12015">end</span><span class="p" data-group-id="12016">)</span><span class="w"></span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">List</span><span class="o">.</span><span class="n">flatten</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="12017">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">internal_app?</span><span class="p" data-group-id="12018">(</span><span class="n">internal_app_names</span><span class="p">,</span><span class="w"> </span><span class="n">app_path</span><span class="p" data-group-id="12018">)</span><span class="w"> </span><span class="k" data-group-id="12021">do</span><span class="w"></span>
<span class="w">    </span><span class="nc">Enum</span><span class="o">.</span><span class="n">member?</span><span class="p" data-group-id="12020">(</span><span class="n">internal_app_names</span><span class="p">,</span><span class="w"> </span><span class="nc">Path</span><span class="o">.</span><span class="n">basename</span><span class="p" data-group-id="12019">(</span><span class="n">app_path</span><span class="p" data-group-id="12019">)</span><span class="p" data-group-id="12020">)</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="12021">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">gather_data_from_modules</span><span class="p" data-group-id="12022">(</span><span class="n">config</span><span class="p" data-group-id="12022">)</span><span class="w"> </span><span class="k" data-group-id="12025">do</span><span class="w"></span>
<span class="w">    </span><span class="n"><a class="guaxinim-source-link" href="#L75">file_references</a></span><span class="p" data-group-id="12023">(</span><span class="n">config</span><span class="p" data-group-id="12023">)</span><span class="w"></span>
<span class="w">    </span><span class="n"><a class="guaxinim-source-link" href="#L242">gather_data_from_modules__async_stream</a></span><span class="p" data-group-id="12024">(</span><span class="n">config</span><span class="p" data-group-id="12024">)</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="12025">end</span><span class="w"></span>
<span class="w"></span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div style="display: flex;" class="guaxinim-docblock guaxinim-inline-comments">
  <table>
    <tbody>
      <tr>
        <td class="left-side">
          <div class="line-anchors">
            <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre>
          </div>
        </td>
        <td class="right-side guaxinim-prose">
          <div class="panel panel-default" style="margin-bottom: 4px">
            <div class="panel-body">
              <p>Alternate implementations for benchmarking purposes</p>

              <div class="end-of-panel-body"></div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
<div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L232"></a><a href="#L232">232</a>
<a id="L233"></a><a href="#L233">233</a>
<a id="L234"></a><a href="#L234">234</a>
<a id="L235"></a><a href="#L235">235</a>
<a id="L236"></a><a href="#L236">236</a>
<a id="L237"></a><a href="#L237">237</a>
<a id="L238"></a><a href="#L238">238</a>
<a id="L239"></a><a href="#L239">239</a>
<a id="L240"></a><a href="#L240">240</a>
<a id="L241"></a><a href="#L241">241</a>
<a id="L242"></a><a href="#L242">242</a>
<a id="L243"></a><a href="#L243">243</a>
<a id="L244"></a><a href="#L244">244</a>
<a id="L245"></a><a href="#L245">245</a>
<a id="L246"></a><a href="#L246">246</a>
<a id="L247"></a><a href="#L247">247</a>
<a id="L248"></a><a href="#L248">248</a>
<a id="L249"></a><a href="#L249">249</a>
<a id="L250"></a><a href="#L250">250</a>
<a id="L251"></a><a href="#L251">251</a>
<a id="L252"></a><a href="#L252">252</a>
<a id="L253"></a><a href="#L253">253</a>
<a id="L254"></a><a href="#L254">254</a>
<a id="L255"></a><a href="#L255">255</a>
<a id="L256"></a><a href="#L256">256</a>
<a id="L257"></a><a href="#L257">257</a>
<a id="L258"></a><a href="#L258">258</a>
<a id="L259"></a><a href="#L259">259</a>
<a id="L260"></a><a href="#L260">260</a>
<a id="L261"></a><a href="#L261">261</a>
<a id="L262"></a><a href="#L262">262</a>
<a id="L263"></a><a href="#L263">263</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="w"></span>
<span class="w">  </span><span class="na">@doc</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">gather_data_from_modules__sequential</span><span class="p" data-group-id="12026">(</span><span class="n">config</span><span class="p" data-group-id="12026">)</span><span class="w"> </span><span class="k" data-group-id="12036">do</span><span class="w"></span>
<span class="w">    </span><span class="n">internal_app_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="12028">[</span><span class="nc">Path</span><span class="o">.</span><span class="n">basename</span><span class="p" data-group-id="12027">(</span><span class="nc">Mix.Project</span><span class="o">.</span><span class="n">app_path</span><span class="p" data-group-id="12027">)</span><span class="p" data-group-id="12028">]</span><span class="w"></span>
<span class="w">    </span><span class="n"><a class="guaxinim-source-link" href="#L210">all_modules</a></span><span class="p" data-group-id="12031">(</span><span class="k" data-group-id="12030">fn</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n"><a class="guaxinim-source-link" href="#L222">internal_app?</a></span><span class="p" data-group-id="12029">(</span><span class="n">internal_app_names</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="p" data-group-id="12029">)</span><span class="w"> </span><span class="k" data-group-id="12030">end</span><span class="p" data-group-id="12031">)</span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="12035">(</span><span class="k" data-group-id="12034">fn</span><span class="w"> </span><span class="p" data-group-id="12032">{</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">internal?</span><span class="p" data-group-id="12032">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"></span>
<span class="w">        </span><span class="n"><a class="guaxinim-source-link" href="#L110">gather_function_definitions_in_module</a></span><span class="p" data-group-id="12033">(</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">internal?</span><span class="p" data-group-id="12033">)</span><span class="w"> </span><span class="k" data-group-id="12034">end</span><span class="p" data-group-id="12035">)</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="12036">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="na">@doc</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">gather_data_from_modules__async_stream</span><span class="p" data-group-id="12037">(</span><span class="n">config</span><span class="p" data-group-id="12037">)</span><span class="w"> </span><span class="k" data-group-id="12053">do</span><span class="w"></span>
<span class="w">    </span><span class="n">internal_app_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="12039">[</span><span class="nc">Path</span><span class="o">.</span><span class="n">basename</span><span class="p" data-group-id="12038">(</span><span class="nc">Mix.Project</span><span class="o">.</span><span class="n">app_path</span><span class="p" data-group-id="12038">)</span><span class="p" data-group-id="12039">]</span><span class="w"></span>
<span class="w"></span>
<span class="w">    </span><span class="n"><a class="guaxinim-source-link" href="#L210">all_modules</a></span><span class="p" data-group-id="12042">(</span><span class="k" data-group-id="12041">fn</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n"><a class="guaxinim-source-link" href="#L222">internal_app?</a></span><span class="p" data-group-id="12040">(</span><span class="n">internal_app_names</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="p" data-group-id="12040">)</span><span class="w"> </span><span class="k" data-group-id="12041">end</span><span class="p" data-group-id="12042">)</span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Task</span><span class="o">.</span><span class="n">async_stream</span><span class="p" data-group-id="12046">(</span><span class="k" data-group-id="12045">fn</span><span class="w"> </span><span class="p" data-group-id="12043">{</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">internal?</span><span class="p" data-group-id="12043">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"></span>
<span class="w">        </span><span class="n"><a class="guaxinim-source-link" href="#L110">gather_function_definitions_in_module</a></span><span class="p" data-group-id="12044">(</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">internal?</span><span class="p" data-group-id="12044">)</span><span class="w"> </span><span class="k" data-group-id="12045">end</span><span class="p" data-group-id="12046">)</span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Stream</span><span class="o">.</span><span class="n">filter</span><span class="p" data-group-id="12049">(</span><span class="k" data-group-id="12048">fn</span><span class="w"> </span><span class="p" data-group-id="12047">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p" data-group-id="12047">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">true</span><span class="p">;</span><span class="w"> </span><span class="bp">_</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="no">false</span><span class="w"> </span><span class="k" data-group-id="12048">end</span><span class="p" data-group-id="12049">)</span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Stream</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="12052">(</span><span class="k" data-group-id="12051">fn</span><span class="w"> </span><span class="p" data-group-id="12050">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p" data-group-id="12050">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="k" data-group-id="12051">end</span><span class="p" data-group-id="12052">)</span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">to_list</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="12053">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="na">@doc</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">gather_data_from_modules__task_async</span><span class="p" data-group-id="12054">(</span><span class="n">config</span><span class="p" data-group-id="12054">)</span><span class="w"> </span><span class="k" data-group-id="12066">do</span><span class="w"></span>
<span class="w">    </span><span class="n">internal_app_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="12056">[</span><span class="nc">Path</span><span class="o">.</span><span class="n">basename</span><span class="p" data-group-id="12055">(</span><span class="nc">Mix.Project</span><span class="o">.</span><span class="n">app_path</span><span class="p" data-group-id="12055">)</span><span class="p" data-group-id="12056">]</span><span class="w"></span>
<span class="w">    </span><span class="n"><a class="guaxinim-source-link" href="#L210">all_modules</a></span><span class="p" data-group-id="12059">(</span><span class="k" data-group-id="12058">fn</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n"><a class="guaxinim-source-link" href="#L222">internal_app?</a></span><span class="p" data-group-id="12057">(</span><span class="n">internal_app_names</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="p" data-group-id="12057">)</span><span class="w"> </span><span class="k" data-group-id="12058">end</span><span class="p" data-group-id="12059">)</span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="12064">(</span><span class="o">&amp;</span><span class="nc">Task</span><span class="o">.</span><span class="n">async</span><span class="p" data-group-id="12063">(</span><span class="k" data-group-id="12062">fn</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"></span>
<span class="w">         </span><span class="p" data-group-id="12060">{</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">internal?</span><span class="p" data-group-id="12060">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ni">&amp;1</span><span class="w"></span>
<span class="w">         </span><span class="n"><a class="guaxinim-source-link" href="#L110">gather_function_definitions_in_module</a></span><span class="p" data-group-id="12061">(</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">internal?</span><span class="p" data-group-id="12061">)</span><span class="w"></span>
<span class="w">       </span><span class="k" data-group-id="12062">end</span><span class="p" data-group-id="12063">)</span><span class="p" data-group-id="12064">)</span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="12065">(</span><span class="o">&amp;</span><span class="nc">Task</span><span class="o">.</span><span class="n">await</span><span class="o">/</span><span class="mi">1</span><span class="p" data-group-id="12065">)</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="12066">end</span><span class="w"></span>
<span class="k" data-group-id="12067">end</span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
        </div>
      </div>
    </div>
  </body>
</html>