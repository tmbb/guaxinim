<html>
  <head>
    <meta charset="UTF-8">
    <!-- Licensed under the Apache 2.0 License -->
    <link rel="stylesheet" type="text/css" href="../../_static/fonts/open-sans/stylesheet.css" />
    <!-- Licensed under the SIL Open Font License -->
    <link rel="stylesheet" type="text/css" href="../../_static/fonts/source-serif-pro/source-serif-pro.css" />
    <!-- Guzzler docs -->
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
    <!--
      <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
    -->
    <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap-theme.min.css" />
    <!-- Guaxinim -->
    <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />

  </head>
  <body>
    <div class="container-wrapper">
      <div id="left-column">
        <div class="sphinxsidebar">
  <a href="#" class="text-logo">
    Guaxinim
  </a>
  <div class="sidebar-block">
    <div class="sidebar-wrapper">
      <h2>Table Of Contents</h2>
    </div>
    <div class="sidebar-toc">
      <ul class="current">
        
        
        <li class="toctree-l1">
          <a class="reference internal" href="..">
            <span class="glyphicon glyphicon-level-up"></span>
            &nbsp;
            <span class="sidebar-toc-level-up">../</span></a></li>
        
        
        
        
        
        <li class="toctree-l1">
          <a class="reference internal" href="path.ex.html">
            <span class="glyphicon glyphicon-file"></span>
            &nbsp;
            <span class="sidebar-toc-file">path.ex</span></a></li>
        
        <li class="toctree-l1">
          <a class="reference internal" href="tokens.ex.html">
            <span class="glyphicon glyphicon-file"></span>
            &nbsp;
            <span class="sidebar-toc-file">tokens.ex</span></a></li>
        
        <li class="toctree-l1">
          <a class="reference internal" href="url.ex.html">
            <span class="glyphicon glyphicon-file"></span>
            &nbsp;
            <span class="sidebar-toc-file">url.ex</span></a></li>
        
      </ul>
    </div>
  </div>
</div>
      </div>

      <div id="right-column">
        <div class="document clearer body">
          <div class="guaxinim-codeblock">
  <table>
    <tbody>
      <tr>
        <td>
          <div class="line-anchors">
            <pre><a id="L1"></a><a href="#L1"> 1</a>
<a id="L2"></a><a href="#L2"> 2</a>
<a id="L3"></a><a href="#L3"> 3</a>
<a id="L4"></a><a href="#L4"> 4</a>
<a id="L5"></a><a href="#L5"> 5</a>
<a id="L6"></a><a href="#L6"> 6</a>
<a id="L7"></a><a href="#L7"> 7</a>
<a id="L8"></a><a href="#L8"> 8</a>
<a id="L9"></a><a href="#L9"> 9</a>
<a id="L10"></a><a href="#L10">10</a>
<a id="L11"></a><a href="#L11">11</a>
<a id="L12"></a><a href="#L12">12</a>
<a id="L13"></a><a href="#L13">13</a>
<a id="L14"></a><a href="#L14">14</a>
<a id="L15"></a><a href="#L15">15</a>
<a id="L16"></a><a href="#L16">16</a>
<a id="L17"></a><a href="#L17">17</a>
<a id="L18"></a><a href="#L18">18</a>
<a id="L19"></a><a href="#L19">19</a>
<a id="L20"></a><a href="#L20">20</a>
<a id="L21"></a><a href="#L21">21</a>
<a id="L22"></a><a href="#L22">22</a>
<a id="L23"></a><a href="#L23">23</a>
<a id="L24"></a><a href="#L24">24</a>
<a id="L25"></a><a href="#L25">25</a>
<a id="L26"></a><a href="#L26">26</a>
<a id="L27"></a><a href="#L27">27</a>
<a id="L28"></a><a href="#L28">28</a>
<a id="L29"></a><a href="#L29">29</a>
<a id="L30"></a><a href="#L30">30</a>
<a id="L31"></a><a href="#L31">31</a>
<a id="L32"></a><a href="#L32">32</a>
<a id="L33"></a><a href="#L33">33</a>
<a id="L34"></a><a href="#L34">34</a>
<a id="L35"></a><a href="#L35">35</a>
<a id="L36"></a><a href="#L36">36</a>
<a id="L37"></a><a href="#L37">37</a>
<a id="L38"></a><a href="#L38">38</a>
<a id="L39"></a><a href="#L39">39</a>
<a id="L40"></a><a href="#L40">40</a>
<a id="L41"></a><a href="#L41">41</a>
<a id="L42"></a><a href="#L42">42</a>
<a id="L43"></a><a href="#L43">43</a>
<a id="L44"></a><a href="#L44">44</a>
<a id="L45"></a><a href="#L45">45</a>
<a id="L46"></a><a href="#L46">46</a>
<a id="L47"></a><a href="#L47">47</a>
<a id="L48"></a><a href="#L48">48</a>
<a id="L49"></a><a href="#L49">49</a>
<a id="L50"></a><a href="#L50">50</a>
<a id="L51"></a><a href="#L51">51</a>
<a id="L52"></a><a href="#L52">52</a>
<a id="L53"></a><a href="#L53">53</a>
<a id="L54"></a><a href="#L54">54</a>
<a id="L55"></a><a href="#L55">55</a>
<a id="L56"></a><a href="#L56">56</a>
<a id="L57"></a><a href="#L57">57</a>
<a id="L58"></a><a href="#L58">58</a>
<a id="L59"></a><a href="#L59">59</a>
<a id="L60"></a><a href="#L60">60</a>
<a id="L61"></a><a href="#L61">61</a>
<a id="L62"></a><a href="#L62">62</a>
<a id="L63"></a><a href="#L63">63</a>
<a id="L64"></a><a href="#L64">64</a>
<a id="L65"></a><a href="#L65">65</a>
<a id="L66"></a><a href="#L66">66</a>
<a id="L67"></a><a href="#L67">67</a>
<a id="L68"></a><a href="#L68">68</a>
<a id="L69"></a><a href="#L69">69</a>
<a id="L70"></a><a href="#L70">70</a>
<a id="L71"></a><a href="#L71">71</a>
<a id="L72"></a><a href="#L72">72</a>
<a id="L73"></a><a href="#L73">73</a>
<a id="L74"></a><a href="#L74">74</a>
<a id="L75"></a><a href="#L75">75</a>
<a id="L76"></a><a href="#L76">76</a>
<a id="L77"></a><a href="#L77">77</a>
<a id="L78"></a><a href="#L78">78</a>
<a id="L79"></a><a href="#L79">79</a>
<a id="L80"></a><a href="#L80">80</a>
<a id="L81"></a><a href="#L81">81</a>
<a id="L82"></a><a href="#L82">82</a>
<a id="L83"></a><a href="#L83">83</a>
<a id="L84"></a><a href="#L84">84</a>
<a id="L85"></a><a href="#L85">85</a>
<a id="L86"></a><a href="#L86">86</a>
<a id="L87"></a><a href="#L87">87</a>
<a id="L88"></a><a href="#L88">88</a>
<a id="L89"></a><a href="#L89">89</a>
<a id="L90"></a><a href="#L90">90</a>
<a id="L91"></a><a href="#L91">91</a>
<a id="L92"></a><a href="#L92">92</a>
<a id="L93"></a><a href="#L93">93</a>
<a id="L94"></a><a href="#L94">94</a>
<a id="L95"></a><a href="#L95">95</a>
<a id="L96"></a><a href="#L96">96</a>
<a id="L97"></a><a href="#L97">97</a>
<a id="L98"></a><a href="#L98">98</a></pre>
          </div>
        </td>
        <td class="right-side guaxinim-code">
          <div class="nohighlight makeup code">
            <pre><span class="kd">defmodule</span><span class="w"> </span><span class="nc">Guaxinim.Utils.Tokens</span><span class="w"> </span><span class="k" data-group-id="12436">do</span><span class="w"></span>
<span class="w">  </span><span class="kn">alias</span><span class="w"> </span><span class="nc">Guaxinim.Database.FunctionCall</span><span class="w"></span>
<span class="w">  </span><span class="kn">alias</span><span class="w"> </span><span class="nc">Makeup.Formatters.HTML.HTMLFormatter</span><span class="w"></span>
<span class="w">  </span><span class="kn">require</span><span class="w"> </span><span class="nc">EEx</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kn">alias</span><span class="w"> </span><span class="nc">Guaxinim.Utils.URL</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">split_into_lines</span><span class="p" data-group-id="12338">(</span><span class="n">tokens</span><span class="p" data-group-id="12338">)</span><span class="w"> </span><span class="k" data-group-id="12372">do</span><span class="w"></span>
<span class="w">    </span><span class="p" data-group-id="12339">{</span><span class="n">lines</span><span class="p">,</span><span class="w"> </span><span class="n">last_line</span><span class="p" data-group-id="12339">}</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="nc">Enum</span><span class="o">.</span><span class="n">reduce</span><span class="w"> </span><span class="n">tokens</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="12342">{</span><span class="p" data-group-id="12340">[]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="12341">[]</span><span class="p" data-group-id="12342">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="12369">(</span><span class="k" data-group-id="12368">fn</span><span class="w"> </span><span class="p" data-group-id="12343">{</span><span class="n">ttype</span><span class="p">,</span><span class="w"> </span><span class="n">meta</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p" data-group-id="12343">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="12344">{</span><span class="n">lines</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="p" data-group-id="12344">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"></span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="nc">String</span><span class="o">.</span><span class="n">split</span><span class="p" data-group-id="12345">(</span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p" data-group-id="12345">)</span><span class="w"> </span><span class="k" data-group-id="12367">do</span><span class="w"></span>
<span class="w">          </span><span class="p" data-group-id="12346">[</span><span class="bp">_</span><span class="p" data-group-id="12346">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p" data-group-id="12348">{</span><span class="n">lines</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="12347">[</span><span class="n">tok</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">line</span><span class="p" data-group-id="12347">]</span><span class="p" data-group-id="12348">}</span><span class="w"></span>
<span class="w">          </span><span class="p" data-group-id="12349">[</span><span class="n">part</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">parts</span><span class="p" data-group-id="12349">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"></span>
<span class="w">            </span><span class="n">first_line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="12351">[</span><span class="p" data-group-id="12350">{</span><span class="n">ttype</span><span class="p">,</span><span class="w"> </span><span class="n">meta</span><span class="p">,</span><span class="w"> </span><span class="n">part</span><span class="p" data-group-id="12350">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">line</span><span class="p" data-group-id="12351">]</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="ss">:lists</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="http://erlang.org/doc/man/lists.html#reverse-1">reverse</a></span><span class="w"></span>
<span class="w"></span>
<span class="w">            </span><span class="n">all_but_last_line</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">              </span><span class="n">parts</span><span class="w"></span>
<span class="w">              </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">slice</span><span class="p" data-group-id="12352">(</span><span class="mi">0</span><span class="o">..-</span><span class="mi">2</span><span class="p" data-group-id="12352">)</span><span class="w"></span>
<span class="w">              </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="12356">(</span><span class="k" data-group-id="12355">fn</span><span class="w"> </span><span class="n">tok_text</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p" data-group-id="12354">[</span><span class="p" data-group-id="12353">{</span><span class="n">ttype</span><span class="p">,</span><span class="w"> </span><span class="n">meta</span><span class="p">,</span><span class="w"> </span><span class="n">tok_text</span><span class="p" data-group-id="12353">}</span><span class="p" data-group-id="12354">]</span><span class="w"> </span><span class="k" data-group-id="12355">end</span><span class="p" data-group-id="12356">)</span><span class="w"></span>
<span class="w">              </span><span class="o">|&gt;</span><span class="w"> </span><span class="ss">:lists</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="http://erlang.org/doc/man/lists.html#reverse-1">reverse</a></span><span class="w"></span>
<span class="w"></span>
<span class="w">            </span><span class="n">last_line_text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">at</span><span class="p" data-group-id="12357">(</span><span class="n">parts</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p" data-group-id="12357">)</span><span class="w"></span>
<span class="w">            </span><span class="n">last_line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="12360">[</span><span class="p" data-group-id="12359">{</span><span class="n">ttype</span><span class="p">,</span><span class="w"> </span><span class="n">meta</span><span class="p">,</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">at</span><span class="p" data-group-id="12358">(</span><span class="n">parts</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p" data-group-id="12358">)</span><span class="p" data-group-id="12359">}</span><span class="p" data-group-id="12360">]</span><span class="w"></span>
<span class="w"></span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">last_line_text</span><span class="w"> </span><span class="k" data-group-id="12366">do</span><span class="w"></span>
<span class="w">              </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p" data-group-id="12363">{</span><span class="n">all_but_last_line</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="p" data-group-id="12361">[</span><span class="n">first_line</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">lines</span><span class="p" data-group-id="12361">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="12362">[]</span><span class="p" data-group-id="12363">}</span><span class="w"></span>
<span class="w">              </span><span class="bp">_</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p" data-group-id="12365">{</span><span class="n">all_but_last_line</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="p" data-group-id="12364">[</span><span class="n">first_line</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">lines</span><span class="p" data-group-id="12364">]</span><span class="p">,</span><span class="w"> </span><span class="n">last_line</span><span class="p" data-group-id="12365">}</span><span class="w"></span>
<span class="w">            </span><span class="k" data-group-id="12366">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">        </span><span class="k" data-group-id="12367">end</span><span class="w"></span>
<span class="w">      </span><span class="k" data-group-id="12368">end</span><span class="p" data-group-id="12369">)</span><span class="w"></span>
<span class="w"></span>
<span class="w">    </span><span class="p" data-group-id="12370">[</span><span class="n">last_line</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">lines</span><span class="p" data-group-id="12370">]</span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="ss">:lists</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="http://erlang.org/doc/man/lists.html#reverse-1">reverse</a></span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">with_index</span><span class="p" data-group-id="12371">(</span><span class="mi">1</span><span class="p" data-group-id="12371">)</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="12372">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="nc">EEx</span><span class="o">.</span><span class="n">function_from_string</span><span class="p" data-group-id="12374">(</span><span class="ss">:defp</span><span class="p">,</span><span class="w"> </span><span class="ss">:render_token</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  &lt;span</span><span class="se">\</span>
<span class="s2">  &lt;%= if css_class do %&gt; class=&quot;&lt;%= css_class %&gt;&quot;&lt;% end %&gt;</span><span class="se">\</span>
<span class="s2">  &lt;%= if meta[:group_id] do %&gt; data-group-id=&quot;&lt;%= meta[:group_id] %&gt;&quot;&lt;% end %&gt;</span><span class="se">\</span>
<span class="s2">  &gt;&lt;a class=&quot;guaxinim-source-link&quot; href=&quot;&lt;%= url %&gt;&quot;&gt;&lt;%= escaped_value %&gt;&lt;/a&gt;&lt;/span&gt;</span><span class="se">\</span>
<span class="s2">  &quot;&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="12373">[</span><span class="ss">:escaped_value</span><span class="p">,</span><span class="w"> </span><span class="ss">:css_class</span><span class="p">,</span><span class="w"> </span><span class="ss">:meta</span><span class="p">,</span><span class="w"> </span><span class="ss">:url</span><span class="p" data-group-id="12373">]</span><span class="p" data-group-id="12374">)</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">format_token_with_link</span><span class="p" data-group-id="12376">(</span><span class="p" data-group-id="12375">{</span><span class="n">tag</span><span class="p">,</span><span class="w"> </span><span class="n">meta</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p" data-group-id="12375">}</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="p" data-group-id="12376">)</span><span class="w"> </span><span class="k" data-group-id="12380">do</span><span class="w"></span>
<span class="w">    </span><span class="n">escaped_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">HtmlEntities</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="https://hexdocs.pm/html_entities/HtmlEntities.html#encode/1">encode</a></span><span class="p" data-group-id="12377">(</span><span class="n">value</span><span class="p" data-group-id="12377">)</span><span class="w"></span>
<span class="w">    </span><span class="n">css_class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Makeup.Token.Utils</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="https://hexdocs.pm/makeup/Makeup.Token.Utils.html#css_class_for_token_type/1">css_class_for_token_type</a></span><span class="p" data-group-id="12378">(</span><span class="n">tag</span><span class="p" data-group-id="12378">)</span><span class="w"></span>
<span class="w">    </span><span class="n"><a class="guaxinim-source-link" href="#L38">render_token</a></span><span class="p" data-group-id="12379">(</span><span class="n">escaped_value</span><span class="p">,</span><span class="w"> </span><span class="n">css_class</span><span class="p">,</span><span class="w"> </span><span class="n">meta</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="p" data-group-id="12379">)</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="12380">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">format_token</span><span class="p" data-group-id="12383">(</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="12382">{</span><span class="p" data-group-id="12381">{</span><span class="ss">:name</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p" data-group-id="12381">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">token</span><span class="p">,</span><span class="w"> </span><span class="n">line_nr</span><span class="p" data-group-id="12382">}</span><span class="p" data-group-id="12383">)</span><span class="w"> </span><span class="k" data-group-id="12394">do</span><span class="w"></span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="nc">FunctionCall</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="../database.ex.html#48">lookup_f_file_line!</a></span><span class="p" data-group-id="12385">(</span><span class="p" data-group-id="12384">{</span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">line_nr</span><span class="p" data-group-id="12384">}</span><span class="p" data-group-id="12385">)</span><span class="w"> </span><span class="k" data-group-id="12393">do</span><span class="w"></span>
<span class="w">      </span><span class="no">nil</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">HTMLFormatter</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="https://hexdocs.pm/makeup/Makeup.Formatters.HTML.HTMLFormatter.html#format_token/1">format_token</a></span><span class="p" data-group-id="12386">(</span><span class="n">token</span><span class="p" data-group-id="12386">)</span><span class="w"></span>
<span class="w"></span>
<span class="w">      </span><span class="p" data-group-id="12387">%{</span><span class="ss">m</span><span class="p">:</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="ss">f</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="ss">a</span><span class="p">:</span><span class="w"> </span><span class="n">a</span><span class="p" data-group-id="12387">}</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"></span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="nc">URL</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="url.ex.html#37">url_for_mfa</a></span><span class="p" data-group-id="12389">(</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="12388">{</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p" data-group-id="12388">}</span><span class="p" data-group-id="12389">)</span><span class="w"> </span><span class="k" data-group-id="12392">do</span><span class="w"></span>
<span class="w">          </span><span class="no">nil</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">HTMLFormatter</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="https://hexdocs.pm/makeup/Makeup.Formatters.HTML.HTMLFormatter.html#format_token/1">format_token</a></span><span class="p" data-group-id="12390">(</span><span class="n">token</span><span class="p" data-group-id="12390">)</span><span class="w"></span>
<span class="w">          </span><span class="n">url</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n"><a class="guaxinim-source-link" href="#L45">format_token_with_link</a></span><span class="p" data-group-id="12391">(</span><span class="n">token</span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="p" data-group-id="12391">)</span><span class="w"></span>
<span class="w">        </span><span class="k" data-group-id="12392">end</span><span class="w"></span>
<span class="w">    </span><span class="k" data-group-id="12393">end</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="12394">end</span><span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">format_token</span><span class="p" data-group-id="12396">(</span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="12395">{</span><span class="n">token</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p" data-group-id="12395">}</span><span class="p" data-group-id="12396">)</span><span class="p">,</span><span class="w"> </span><span class="ss">do</span><span class="p">:</span><span class="w"> </span><span class="nc">HTMLFormatter</span><span class="o">.</span><span class="n"><a class="guaxinim-source-link" href="https://hexdocs.pm/makeup/Makeup.Formatters.HTML.HTMLFormatter.html#format_token/1">format_token</a></span><span class="p" data-group-id="12397">(</span><span class="n">token</span><span class="p" data-group-id="12397">)</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kd">defp</span><span class="w"> </span><span class="n">line_to_html</span><span class="p" data-group-id="12399">(</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="12398">{</span><span class="n">tokens</span><span class="p">,</span><span class="w"> </span><span class="n">line_nr</span><span class="p" data-group-id="12398">}</span><span class="p" data-group-id="12399">)</span><span class="w"> </span><span class="k" data-group-id="12405">do</span><span class="w"></span>
<span class="w">    </span><span class="n">tokens</span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="12403">(</span><span class="k" data-group-id="12402">fn</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n"><a class="guaxinim-source-link" href="#L62">format_token</a></span><span class="p" data-group-id="12401">(</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="12400">{</span><span class="n">token</span><span class="p">,</span><span class="w"> </span><span class="n">line_nr</span><span class="p" data-group-id="12400">}</span><span class="p" data-group-id="12401">)</span><span class="w"> </span><span class="k" data-group-id="12402">end</span><span class="p" data-group-id="12403">)</span><span class="w"></span>
<span class="w">    </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">join</span><span class="p" data-group-id="12404">(</span><span class="s2">&quot;&quot;</span><span class="p" data-group-id="12404">)</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="12405">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kd">defp</span><span class="w"> </span><span class="n">line_nr_anchor</span><span class="p" data-group-id="12406">(</span><span class="n">line_nr</span><span class="p">,</span><span class="w"> </span><span class="n">anchor_padding</span><span class="p">,</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="12406">)</span><span class="w"> </span><span class="k" data-group-id="12417">do</span><span class="w"></span>
<span class="w">    </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">line_nr</span><span class="w"></span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Integer</span><span class="o">.</span><span class="n">to_string</span><span class="w"></span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">String</span><span class="o">.</span><span class="n">pad_leading</span><span class="p" data-group-id="12407">(</span><span class="n">anchor_padding</span><span class="p" data-group-id="12407">)</span><span class="w"></span>
<span class="w"></span>
<span class="w">    </span><span class="s">~s(&lt;a id=&quot;L</span><span class="si" data-group-id="12410">#{</span><span class="n">line_nr</span><span class="si" data-group-id="12410">}</span><span class="s">&quot;&gt;&lt;/a&gt;&lt;a href=&quot;#L</span><span class="si" data-group-id="12413">#{</span><span class="n">line_nr</span><span class="si" data-group-id="12413">}</span><span class="s">&quot;&gt;</span><span class="si" data-group-id="12416">#{</span><span class="n">text</span><span class="si" data-group-id="12416">}</span><span class="s">&lt;/a&gt;)</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="12417">end</span><span class="w"></span>
<span class="w">  </span><span class="kd">defp</span><span class="w"> </span><span class="n">line_nr_anchor</span><span class="p" data-group-id="12418">(</span><span class="n">line_nr</span><span class="p">,</span><span class="w"> </span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="no">false</span><span class="p" data-group-id="12418">)</span><span class="w"> </span><span class="k" data-group-id="12422">do</span><span class="w"></span>
<span class="w">    </span><span class="s">~s(&lt;a id=&quot;L</span><span class="si" data-group-id="12421">#{</span><span class="n">line_nr</span><span class="si" data-group-id="12421">}</span><span class="s">&quot;&gt;&lt;/a&gt;)</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="12422">end</span><span class="w"></span>
<span class="w"></span>
<span class="w">  </span><span class="kd">def</span><span class="w"> </span><span class="nf">lines_to_html_data</span><span class="p" data-group-id="12423">(</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">anchor_padding</span><span class="p">,</span><span class="w"> </span><span class="n">token_lines</span><span class="p">,</span><span class="w"> </span><span class="n">line_numbers?</span><span class="w"> </span><span class="o">\\</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="12423">)</span><span class="w"> </span><span class="k" data-group-id="12435">do</span><span class="w"></span>
<span class="w">    </span><span class="n">code</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">token_lines</span><span class="w"></span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="12426">(</span><span class="k" data-group-id="12425">fn</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n"><a class="guaxinim-source-link" href="#L64">line_to_html</a></span><span class="p" data-group-id="12424">(</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="p" data-group-id="12424">)</span><span class="w"> </span><span class="k" data-group-id="12425">end</span><span class="p" data-group-id="12426">)</span><span class="w"></span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">join</span><span class="p" data-group-id="12427">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p" data-group-id="12427">)</span><span class="w"></span>
<span class="w"></span>
<span class="w">    </span><span class="p" data-group-id="12428">{</span><span class="bp">_</span><span class="p">,</span><span class="w"> </span><span class="n">line_numbers</span><span class="p" data-group-id="12428">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">unzip</span><span class="p" data-group-id="12429">(</span><span class="n">token_lines</span><span class="p" data-group-id="12429">)</span><span class="w"></span>
<span class="w">    </span><span class="n">anchors</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="n">line_numbers</span><span class="w"></span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">map</span><span class="p" data-group-id="12432">(</span><span class="k" data-group-id="12431">fn</span><span class="w"> </span><span class="n">line_nr</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"></span>
<span class="w">           </span><span class="n"><a class="guaxinim-source-link" href="#L78">line_nr_anchor</a></span><span class="p" data-group-id="12430">(</span><span class="n">line_nr</span><span class="p">,</span><span class="w"> </span><span class="n">anchor_padding</span><span class="p">,</span><span class="w"> </span><span class="n">line_numbers?</span><span class="p" data-group-id="12430">)</span><span class="w"></span>
<span class="w">         </span><span class="k" data-group-id="12431">end</span><span class="p" data-group-id="12432">)</span><span class="w"></span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Enum</span><span class="o">.</span><span class="n">join</span><span class="p" data-group-id="12433">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p" data-group-id="12433">)</span><span class="w"></span>
<span class="w"></span>
<span class="w">    </span><span class="p" data-group-id="12434">{</span><span class="n">anchors</span><span class="p">,</span><span class="w"> </span><span class="n">code</span><span class="p" data-group-id="12434">}</span><span class="w"></span>
<span class="w">  </span><span class="k" data-group-id="12435">end</span><span class="w"></span>
<span class="k" data-group-id="12436">end</span></pre>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
        </div>
      </div>
    </div>
  </body>
</html>